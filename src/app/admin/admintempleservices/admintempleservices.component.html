<app-adminheader></app-adminheader>

<form #templeForm="ngForm" (ngSubmit)="templeForm.form.valid && AddTemple(templeForm)" novalidate>
    <div class="row">
        <div class="container card border-primary  p-4">
            <h4>Add Temples :</h4>
            <hr />
            <div class="form-group row">

                <div class="col-12">
                    <div class="form-group row">
                        <div class="col-4">
                            <label><b>Temple Type :</b></label>
                        </div>
                        <div class="col-4" *ngFor="let type of templeType">
                            <input id="type.templeTypeId" type="radio" [value]="type.templeTypeId" name="templeType"
                                [(ngModel)]="templeModel.TempleTypeId" required> &nbsp;
                            <label>{{type.templeTypeName}}</label>
                        </div>
                        <div class="text-danger col-10" style="text-align: center;"
                            *ngIf="templeForm.invalid && templeForm.untouched">
                            <p>Please select Temple Type</p>
                        </div>
                    </div>
                </div>

                <div class="col-7">
                    <div class="form-group row">
                        <div class="col-5">
                            <label><b>Temple Name :</b></label>
                        </div>
                        <div class="col-7">
                            <input type="text" class="form-control" id="templeName" name="templeName"
                                [(ngModel)]="templeModel.TempleName" #templeName="ngModel" required autocomplete="off">
                            <span class="text-danger"
                                *ngIf="(templeName.touched || templeForm.submitted) && templeName.errors?.required">
                                Temple Name is required
                            </span>
                        </div>
                    </div>
                </div>

                <div class="col-12">
                    <div class="form-group">
                        <label><b>About Temple :</b></label>
                    </div>
                </div>

                <div class="col-12">
                    <div class="form-group">
                        <quill-editor [styles]="{height: '200px'}" name="about_temple"
                            [(ngModel)]="templeModel.AboutTemple" trackChanges="all" #about_temple="ngModel"
                            maxlength="200" placeholder="Enter Short Description about Temple (100-200 characters)"
                            [modules]="modules" required>
                        </quill-editor>
                        <span class="text-danger"
                            *ngIf="(about_temple.touched || templeForm.submitted) && about_temple.errors?.required">
                            About Temple is required
                        </span>
                        <span class="text-danger" *ngIf="(about_temple.errors?.maxlength)">
                            Enter below 200 characters.
                        </span>
                    </div>
                </div>

                <div class="col-12">
                    <div class="form-group">
                        <label><b>Temple History And Description :</b></label>
                    </div>
                </div>

                <div class="col-12">
                    <div class="form-group">
                        <quill-editor [styles]="{height: '200px'}" name="temple_description"
                            [(ngModel)]="templeModel.TempleDescription" trackChanges="all" #temple_description="ngModel"
                            placeholder="Temple History, Temple Description etc" [modules]="modules" required>
                        </quill-editor>
                        <span class="text-danger"
                            *ngIf="(temple_description.touched || templeForm.submitted) && temple_description.errors?.required">
                            Temple History is required
                        </span>
                    </div>
                </div>

                <div class="col-12">
                    <div class="form-group">
                        <label><b>Transport Details :</b></label>
                    </div>
                </div>

                <div class="col-12">
                    <div class="form-group">
                        <quill-editor [styles]="{height: '200px'}" name="transport"
                            [(ngModel)]="templeModel.TempleTransport" trackChanges="all" #transport="ngModel"
                            placeholder="Transport Details" [modules]="modules" required>
                        </quill-editor>
                        <!-- <span class="text-danger"
                            *ngIf="(transport.touched || templeForm.submitted) && transport.errors?.required">
                            Temple History is required
                        </span> -->
                    </div>
                </div>

                <div class="col-8">
                    <div class="col-10">
                        <div class="form-group row">
                            <div class="col-5">
                                <label><b>State </b></label>
                            </div>
                            <div class="col-7">
                                <select name="stateID" [(ngModel)]="templeModel.StateId" class="form-control"
                                    (change)="onStateChange()" #stateID="ngModel" required>
                                    <option *ngFor="let state of States" [value]="state.stateID">
                                        {{state.stateName}}
                                    </option>
                                </select>
                                <span class="text-danger"
                                    *ngIf="(stateID.touched || templeForm.submitted) && stateID.errors?.required">
                                    State is required
                                </span>
                            </div>
                        </div>
                    </div>

                    <div class="col-10">
                        <div class="form-group row">
                            <div class="col-5">
                                <label><b>City </b></label>
                            </div>
                            <div class="col-7">
                                <select name="cityID" [(ngModel)]="templeModel.CityId" class="form-control"
                                    #cityID="ngModel" required>
                                    <option *ngFor="let city of Cities" [value]="city.cityID">
                                        {{city.cityName}}
                                    </option>
                                </select>
                                <span class="text-danger"
                                    *ngIf="(cityID.touched || templeForm.submitted) && cityID.errors?.required">
                                    City is required
                                </span>
                            </div>
                        </div>
                    </div>

                    <div class="col-10">
                        <div class="form-group row">
                            <div class="col-5">
                                <label><b>Temple Image</b></label>
                            </div>
                            <div class="col-7">
                                <input type="file" accept="image/*" #file (change)="upload($event)" name="templeImage"
                                    #inputFile required />
                            </div>
                        </div>
                    </div>
                </div>

                <div class="col-4 ">
                    <div class="imagePreview" *ngIf="imageURL && imageURL !== ''">
                        <img [src]="imageURL" name="imgPreview" width="200px" height="200px">
                    </div>
                </div>

                <div class="col-12">
                    <div class="form-group row">
                        <div class="col-6">
                            <b>
                                Services/Puja, Darshan with Timings :
                            </b>
                        </div>
                    </div>
                    <div class="form-group row">
                        <table class="table table-striped table-bordered">
                            <thead>
                                <th>ACTION</th>
                                <th>Service/Puja</th>
                                <th>Timings</th>
                                <th>Price</th>
                                <th></th>
                            </thead>
                            <tbody>
                                <tr *ngFor="let service of serviceTimings; let i = index;">
                                    <td (click)="deleteService(i)">
                                        <i class="fa fa-trash fa-2x"></i>
                                    </td>

                                    <td>
                                        <input [(ngModel)]="service.serviceName" name="serviceName[-{{i}}]"
                                            id="serviceName" class="form-control" type="text" autocomplete="off" />
                                    </td>
                                    <td>
                                        <input [(ngModel)]="service.serviceTimings" name="serviceTimings[-{{i}}]"
                                            id="serviceTimings" class="form-control" type="text" autocomplete="off" />
                                    </td>
                                    <td>
                                        <input [(ngModel)]="service.servicePrice" name="servicePrice[-{{i}}]"
                                            id="servicePrice" class="form-control" type="number" autocomplete="off" />
                                    </td>
                                    <td (click)="addService(i)">
                                        <i class="fa fa-plus fa-2x"></i>
                                    </td>
                                </tr>

                            </tbody>
                        </table>
                    </div>
                </div>

                <div class="col-12">
                    <div class="form-group row">
                        <div class="col-6">
                            <b>
                                Accommodation with Timings :
                            </b>
                        </div>
                    </div>
                    <div class="form-group row">
                        <table class="table table-striped table-bordered">
                            <thead>
                                <th>ACTION</th>
                                <th>Accommodation</th>
                                <th>Timings</th>
                                <th>Price</th>
                                <th></th>
                            </thead>
                            <tbody>
                                <tr *ngFor="let room of accommodationTimings; let i = index;">
                                    <td (click)="deleteAccommodation(i)">
                                        <i class="fa fa-trash fa-2x"></i>
                                    </td>

                                    <td>
                                        <input [(ngModel)]="room.roomType" name="roomType[-{{i}}]"
                                            id="roomType" class="form-control" type="text" autocomplete="off" />
                                    </td>
                                    <td>
                                        <input [(ngModel)]="room.roomTimings" name="roomTimings[-{{i}}]"
                                            id="roomTimings" class="form-control" type="text" autocomplete="off" />
                                    </td>
                                    <td>
                                        <input [(ngModel)]="room.roomPrice" name="roomPrice[-{{i}}]"
                                            id="roomPrice" class="form-control" type="number" autocomplete="off" />
                                    </td>
                                    <td (click)="addAccommodation(i)">
                                        <i class="fa fa-plus fa-2x"></i>
                                    </td>
                                </tr>

                            </tbody>
                        </table>
                    </div>
                </div>

                <div class="col-12">
                    <div class="form-group">
                        <label><b>Customer Comments or Reviews :</b></label>
                    </div>
                </div>

                <div class="col-12">
                    <div class="form-group">
                        <quill-editor [styles]="{height: '200px'}" name="customerComments"
                            [(ngModel)]="templeModel.CustomerReviews" trackChanges="all" #customerComments="ngModel"
                            [modules]="modules" required>
                        </quill-editor>
                        <span class="text-danger"
                            *ngIf="(customerComments.touched || templeForm.submitted) && customerComments.errors?.required">
                            Comments is required
                        </span>
                    </div>
                </div>

                <div class="col-12">
                    <div class="form-group">
                        <div class="col-3">
                            <button type="submit" class="btn btn-primary col-12">{{btntext}}</button>
                        </div>
                    </div>
                </div>

                <hr>

                <div class="container p-2 tabledata">
                    <h4 class="text-info">Service Details</h4><br>
                    <table class="table table-striped table-bordered">
                        <tr>
                            <th>Temple Image</th>
                            <th>Temple Type</th>
                            <th>Temple Name</th>
                            <th>About Temple</th>
                            <th>Temple Description</th>
                            <th>Temple Transport</th>
                            <th>State</th>
                            <th>City</th>
                            <th>Service - Timings - Price</th>
                            <th>Accommodation - Timings - Price</th>
                            <th>Customer Reviews</th>
                            <th class="columnWidth">Action</th>
                        </tr>
                        <tr *ngFor="let temple of templeDetails; let i=index"
                            [ngClass]="{'active': selectedIndex == i}">
                            <td><img src="data:image/png;base64,{{temple.templeImage}}" width="40px" height="40px" />
                            </td>
                            <td>{{temple.templeType}}</td>
                            <td>{{temple.templeName}}</td>
                            <td><span style="font-size: 13px" [innerHTML]="temple.aboutTemple"></span></td>
                            <td><span style="font-size: 13px" [innerHTML]="temple.templeDescription"></span></td>
                            <td><span style="font-size: 13px" [innerHTML]="temple.templeTransport"></span></td>
                            <td>{{temple.stateName}}</td>
                            <td>{{temple.cityName}}</td>
                            <td>
                                <pre><span style="font-size: 13px" [innerHTML]="temple.servTimings"></span></pre>
                            </td>
                            <td>
                                <pre><span style="font-size: 13px" [innerHTML]="temple.roomTimings"></span></pre>
                            </td>
                            <td><span style="font-size: 13px" [innerHTML]="temple.customerReviews"></span>
                            </td>
                            <td class="columnWidth">
                                <button type="button" class="btn btn-secondary" (click)="onEdit(temple)">Edit</button>
                                <button type="button" class="btn btn-danger" (click)="onDelete(temple)">Delete</button>
                            </td>
                        </tr>
                    </table>
                </div>

            </div>
        </div>
    </div>
</form>

<footer></footer>